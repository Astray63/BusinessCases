<div class="min-h-screen bg-gradient-to-br from-gray-50 to-blue-50 p-6" *ngIf="currentUser && !loading">
  <!-- En-t√™te avec message de bienvenue -->
  <header class="mb-8 bg-white rounded-2xl shadow-lg p-8">
    <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
      <div>
        <h1 class="text-4xl font-bold text-gray-900 mb-2">Bonjour, {{ currentUser.prenom }} üëã</h1>
        <p class="text-lg text-gray-600">Bienvenue sur votre tableau de bord</p>
      </div>
      <div class="flex flex-wrap gap-3">
        <span class="inline-flex items-center px-4 py-2 rounded-full text-sm font-semibold"
              [class.bg-gradient-to-r]="currentUser.role === 'admin'"
              [class.from-purple-500]="currentUser.role === 'admin'"
              [class.to-pink-500]="currentUser.role === 'admin'"
              [class.text-white]="currentUser.role === 'admin'"
              [class.bg-blue-100]="currentUser.role !== 'admin'"
              [class.text-blue-800]="currentUser.role !== 'admin'">
          {{ currentUser.role === 'admin' ? 'üëë Administrateur' : 'üë§ Utilisateur' }}
        </span>
        <span class="inline-flex items-center px-4 py-2 bg-gradient-to-r from-orange-500 to-yellow-500 text-white rounded-full text-sm font-semibold" *ngIf="isProprietaire">
          ‚ö° Propri√©taire
        </span>
      </div>
    </div>
  </header>

  <!-- Section Statistiques Client -->
  <section class="mb-12">
    <div class="mb-6">
      <h2 class="text-2xl font-bold text-gray-900 flex items-center gap-2">
        <span class="text-blue-600">üîµ</span>
        Mes r√©servations
      </h2>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
      <!-- Card 1: Total r√©servations -->
      <div class="bg-white rounded-xl shadow-md p-6 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
        <div class="flex items-start justify-between">
          <div class="flex-1">
            <p class="text-gray-600 text-sm font-medium mb-2">R√©servations totales</p>
            <p class="text-4xl font-bold text-blue-600 mb-1">{{ dashboardStats?.clientStats?.totalReservations || 0 }}</p>
            <p class="text-xs text-gray-500">{{ dashboardStats?.clientStats?.reservationsCeMois || 0 }} ce mois-ci</p>
          </div>
          <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
            <i class="bi bi-calendar-check text-2xl text-blue-600"></i>
          </div>
        </div>
      </div>

      <!-- Card 2: Actives -->
      <div class="bg-white rounded-xl shadow-md p-6 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
        <div class="flex items-start justify-between">
          <div class="flex-1">
            <p class="text-gray-600 text-sm font-medium mb-2">Actives</p>
            <p class="text-4xl font-bold text-green-600 mb-1">{{ dashboardStats?.clientStats?.reservationsEnCours || 0 }}</p>
            <p class="text-xs text-gray-500">En cours d'utilisation</p>
          </div>
          <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
            <i class="bi bi-lightning-charge-fill text-2xl text-green-600"></i>
          </div>
        </div>
      </div>

      <!-- Card 3: Termin√©es -->
      <div class="bg-white rounded-xl shadow-md p-6 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
        <div class="flex items-start justify-between">
          <div class="flex-1">
            <p class="text-gray-600 text-sm font-medium mb-2">Termin√©es</p>
            <p class="text-4xl font-bold text-cyan-600 mb-1">{{ dashboardStats?.clientStats?.reservationsTerminees || 0 }}</p>
            <p class="text-xs text-gray-500">Compl√©t√©es avec succ√®s</p>
          </div>
          <div class="w-12 h-12 bg-cyan-100 rounded-lg flex items-center justify-center">
            <i class="bi bi-check-circle-fill text-2xl text-cyan-600"></i>
          </div>
        </div>
      </div>

      <!-- Card 4: D√©penses -->
      <div class="bg-white rounded-xl shadow-md p-6 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
        <div class="flex items-start justify-between">
          <div class="flex-1">
            <p class="text-gray-600 text-sm font-medium mb-2">D√©penses du mois</p>
            <p class="text-4xl font-bold text-amber-600 mb-1">{{ dashboardStats?.clientStats?.montantMoisEnCours | currency:'EUR':'symbol':'1.0-0' }}</p>
            <p class="text-xs text-gray-500">Total: {{ dashboardStats?.clientStats?.montantTotalDepense | currency:'EUR':'symbol':'1.0-0' }}</p>
          </div>
          <div class="w-12 h-12 bg-amber-100 rounded-lg flex items-center justify-center">
            <i class="bi bi-wallet2 text-2xl text-amber-600"></i>
          </div>
        </div>
      </div>
    </div>

    <!-- Prochaine r√©servation -->
    <div class="bg-gradient-to-r from-blue-500 to-purple-600 rounded-xl shadow-lg p-6 text-white mb-6" *ngIf="dashboardStats?.clientStats?.prochaineReservation">
      <h3 class="text-xl font-bold mb-4 flex items-center gap-2">
        <span>üéØ</span>
        Prochaine r√©servation
      </h3>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4 bg-white/10 rounded-lg p-4 backdrop-blur-sm">
        <div>
          <p class="text-sm opacity-90">Borne</p>
          <p class="font-semibold text-lg">{{ dashboardStats?.clientStats?.prochaineReservation?.borne?.nom }}</p>
        </div>
        <div>
          <p class="text-sm opacity-90">Lieu</p>
          <p class="font-semibold text-lg">{{ dashboardStats?.clientStats?.prochaineReservation?.borne?.localisation }}</p>
        </div>
        <div>
          <p class="text-sm opacity-90">D√©but</p>
          <p class="font-semibold text-lg">{{ dashboardStats?.clientStats?.prochaineReservation?.dateDebut | date:'dd/MM/yyyy √† HH:mm' }}</p>
        </div>
        <div>
          <p class="text-sm opacity-90">Fin</p>
          <p class="font-semibold text-lg">{{ dashboardStats?.clientStats?.prochaineReservation?.dateFin | date:'dd/MM/yyyy √† HH:mm' }}</p>
        </div>
      </div>
    </div>

    <!-- Actions rapides Client -->
    <div class="flex flex-wrap gap-4">
      <button class="flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg transition-all duration-200 transform hover:scale-105 shadow-lg"
              (click)="reserverBorne()">
        <i class="bi bi-search text-xl"></i>
        <span>Rechercher une borne</span>
      </button>
      <button class="flex items-center gap-2 px-6 py-3 bg-gray-700 hover:bg-gray-800 text-white font-semibold rounded-lg transition-all duration-200 transform hover:scale-105 shadow-lg"
              (click)="voirMesReservations()">
        <i class="bi bi-list-ul text-xl"></i>
        <span>Voir toutes mes r√©servations</span>
      </button>
    </div>
  </section>

  <!-- Section Propri√©taire -->
  <section class="mb-12" *ngIf="isProprietaire && dashboardStats?.ownerStats">
    <div class="mb-6">
      <h2 class="text-2xl font-bold text-gray-900 flex items-center gap-2">
        <span class="text-green-600">üü¢</span>
        Mes bornes de recharge
      </h2>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
      <!-- Card 1: Bornes totales -->
      <div class="bg-white rounded-xl shadow-md p-6 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
        <div class="flex items-start justify-between">
          <div class="flex-1">
            <p class="text-gray-600 text-sm font-medium mb-2">Bornes totales</p>
            <p class="text-4xl font-bold text-purple-600 mb-1">{{ dashboardStats?.ownerStats?.totalBornes }}</p>
            <p class="text-xs text-gray-500">{{ dashboardStats?.ownerStats?.bornesDisponibles }} disponibles</p>
          </div>
          <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center">
            <i class="bi bi-ev-station-fill text-2xl text-purple-600"></i>
          </div>
        </div>
      </div>

      <!-- Card 2: Revenus -->
      <div class="bg-white rounded-xl shadow-md p-6 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
        <div class="flex items-start justify-between">
          <div class="flex-1">
            <p class="text-gray-600 text-sm font-medium mb-2">Revenus ce mois</p>
            <p class="text-4xl font-bold text-emerald-600 mb-1">{{ dashboardStats?.ownerStats?.revenusEstimesMois | currency:'EUR':'symbol':'1.0-0' }}</p>
            <p class="text-xs text-gray-500">Total: {{ dashboardStats?.ownerStats?.revenusTotaux | currency:'EUR':'symbol':'1.0-0' }}</p>
          </div>
          <div class="w-12 h-12 bg-emerald-100 rounded-lg flex items-center justify-center">
            <i class="bi bi-currency-euro text-2xl text-emerald-600"></i>
          </div>
        </div>
      </div>

      <!-- Card 3: Demandes -->
      <div class="bg-white rounded-xl shadow-md p-6 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
        <div class="flex items-start justify-between">
          <div class="flex-1">
            <p class="text-gray-600 text-sm font-medium mb-2">Demandes en attente</p>
            <p class="text-4xl font-bold text-red-600 mb-1">{{ dashboardStats?.ownerStats?.demandesEnAttente }}</p>
            <p class="text-xs text-gray-500">√Ä traiter rapidement</p>
          </div>
          <div class="w-12 h-12 bg-red-100 rounded-lg flex items-center justify-center">
            <i class="bi bi-inbox-fill text-2xl text-red-600"></i>
          </div>
        </div>
      </div>

      <!-- Card 4: Taux d'occupation -->
      <div class="bg-white rounded-xl shadow-md p-6 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
        <div class="flex items-start justify-between">
          <div class="flex-1">
            <p class="text-gray-600 text-sm font-medium mb-2">Taux d'occupation</p>
            <p class="text-4xl font-bold text-teal-600 mb-1">{{ dashboardStats?.ownerStats?.tauxOccupationMoyen }}%</p>
            <p class="text-xs text-gray-500">{{ dashboardStats?.ownerStats?.totalReservations }} r√©servations</p>
          </div>
          <div class="w-12 h-12 bg-teal-100 rounded-lg flex items-center justify-center">
            <i class="bi bi-graph-up-arrow text-2xl text-teal-600"></i>
          </div>
        </div>
      </div>
    </div>

    <!-- √âtat des bornes -->
    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
      <div class="bg-white rounded-xl shadow-md p-6 text-center hover:shadow-lg transition-shadow">
        <div class="text-4xl font-bold text-green-600 mb-2">{{ dashboardStats?.ownerStats?.bornesDisponibles }}</div>
        <div class="text-sm font-medium text-gray-600">Disponibles</div>
        <div class="mt-2 h-2 bg-green-200 rounded-full">
          <div class="h-full bg-green-600 rounded-full" style="width: 100%"></div>
        </div>
      </div>
      <div class="bg-white rounded-xl shadow-md p-6 text-center hover:shadow-lg transition-shadow">
        <div class="text-4xl font-bold text-orange-600 mb-2">{{ dashboardStats?.ownerStats?.bornesOccupees }}</div>
        <div class="text-sm font-medium text-gray-600">Occup√©es</div>
        <div class="mt-2 h-2 bg-orange-200 rounded-full">
          <div class="h-full bg-orange-600 rounded-full" style="width: 100%"></div>
        </div>
      </div>
      <div class="bg-white rounded-xl shadow-md p-6 text-center hover:shadow-lg transition-shadow">
        <div class="text-4xl font-bold text-blue-600 mb-2">{{ dashboardStats?.ownerStats?.bornesMaintenance }}</div>
        <div class="text-sm font-medium text-gray-600">En maintenance</div>
        <div class="mt-2 h-2 bg-blue-200 rounded-full">
          <div class="h-full bg-blue-600 rounded-full" style="width: 100%"></div>
        </div>
      </div>
      <div class="bg-white rounded-xl shadow-md p-6 text-center hover:shadow-lg transition-shadow">
        <div class="text-4xl font-bold text-red-600 mb-2">{{ dashboardStats?.ownerStats?.bornesHorsService }}</div>
        <div class="text-sm font-medium text-gray-600">Hors service</div>
        <div class="mt-2 h-2 bg-red-200 rounded-full">
          <div class="h-full bg-red-600 rounded-full" style="width: 100%"></div>
        </div>
      </div>
    </div>

    <!-- Borne la plus populaire -->
    <div class="bg-gradient-to-r from-orange-500 to-pink-600 rounded-xl shadow-lg p-6 text-white mb-6" *ngIf="dashboardStats?.ownerStats?.borneLaPlusReservee">
      <h3 class="text-xl font-bold mb-4 flex items-center gap-2">
        <span>‚≠ê</span>
        Borne la plus r√©serv√©e
      </h3>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 bg-white/10 rounded-lg p-4 backdrop-blur-sm">
        <div>
          <p class="text-sm opacity-90">Nom</p>
          <p class="font-semibold text-lg">{{ dashboardStats?.ownerStats?.borneLaPlusReservee?.nom }}</p>
        </div>
        <div>
          <p class="text-sm opacity-90">Localisation</p>
          <p class="font-semibold text-lg">{{ dashboardStats?.ownerStats?.borneLaPlusReservee?.localisation }}</p>
        </div>
        <div>
          <p class="text-sm opacity-90">Puissance</p>
          <p class="font-semibold text-lg">{{ dashboardStats?.ownerStats?.borneLaPlusReservee?.puissance }} kW</p>
        </div>
        <div>
          <p class="text-sm opacity-90">Prix</p>
          <p class="font-semibold text-lg">{{ dashboardStats?.ownerStats?.borneLaPlusReservee?.prixALaMinute | currency:'EUR':'symbol':'1.2-2' }}/min</p>
        </div>
      </div>
    </div>

    <!-- Actions rapides Propri√©taire -->
    <div class="flex flex-wrap gap-4">
      <button class="flex items-center gap-2 px-6 py-3 bg-green-600 hover:bg-green-700 text-white font-semibold rounded-lg transition-all duration-200 transform hover:scale-105 shadow-lg"
              (click)="ajouterBorne()">
        <i class="bi bi-plus-circle-fill text-xl"></i>
        <span>Ajouter une borne</span>
      </button>
      <button class="flex items-center gap-2 px-6 py-3 bg-orange-600 hover:bg-orange-700 text-white font-semibold rounded-lg transition-all duration-200 transform hover:scale-105 shadow-lg"
              (click)="voirMesBornes()">
        <i class="bi bi-lightning-charge text-xl"></i>
        <span>G√©rer mes bornes</span>
      </button>
      <button class="flex items-center gap-2 px-6 py-3 bg-gray-700 hover:bg-gray-800 text-white font-semibold rounded-lg transition-all duration-200 transform hover:scale-105 shadow-lg"
              (click)="voirDemandesReservation()">
        <i class="bi bi-inbox text-xl"></i>
        <span>Voir les demandes</span>
      </button>
    </div>
  </section>

  <!-- Call to Action - Devenir propri√©taire -->
  <section *ngIf="!isProprietaire">
    <div class="bg-gradient-to-r from-purple-600 via-pink-600 to-orange-500 rounded-2xl shadow-2xl overflow-hidden">
      <div class="p-8 md:p-12">
        <div class="text-center mb-8">
          <div class="text-6xl mb-4">üí°</div>
          <h2 class="text-3xl md:text-4xl font-bold text-white mb-4">Vous poss√©dez une borne de recharge ?</h2>
          <p class="text-lg text-white/90 max-w-2xl mx-auto">Mettez-la en location et g√©n√©rez des revenus passifs tout en aidant la communaut√© !</p>
        </div>
        
        <div class="flex justify-center mb-8">
          <button class="px-8 py-4 bg-white text-purple-600 font-bold text-lg rounded-lg hover:bg-gray-100 transition-all duration-200 transform hover:scale-105 shadow-xl"
                  (click)="devenirProprietaire()">
            <i class="bi bi-lightning-charge-fill mr-2"></i>
            Devenir propri√©taire
          </button>
        </div>
        
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 max-w-4xl mx-auto">
          <div class="bg-white/10 backdrop-blur-sm rounded-lg p-6 text-center text-white">
            <i class="bi bi-check-circle-fill text-3xl mb-3"></i>
            <p class="font-semibold">Revenus compl√©mentaires</p>
          </div>
          <div class="bg-white/10 backdrop-blur-sm rounded-lg p-6 text-center text-white">
            <i class="bi bi-check-circle-fill text-3xl mb-3"></i>
            <p class="font-semibold">Gestion simplifi√©e</p>
          </div>
          <div class="bg-white/10 backdrop-blur-sm rounded-lg p-6 text-center text-white">
            <i class="bi bi-check-circle-fill text-3xl mb-3"></i>
            <p class="font-semibold">Impact √©cologique positif</p>
          </div>
        </div>
      </div>
    </div>
  </section>
</div>

<!-- Loading State -->
<div class="min-h-screen bg-gray-50 flex flex-col items-center justify-center p-6" *ngIf="loading">
  <div class="animate-spin rounded-full h-20 w-20 border-t-4 border-b-4 border-blue-600 mb-6"></div>
  <p class="text-gray-600 text-xl font-medium">Chargement de votre tableau de bord...</p>
</div>

<!-- Empty State -->
<div class="min-h-screen bg-gray-50 flex flex-col items-center justify-center p-6" *ngIf="!currentUser && !loading">
  <div class="text-center bg-white rounded-2xl shadow-xl p-12 max-w-md">
    <div class="text-6xl mb-6">üîí</div>
    <h2 class="text-3xl font-bold text-gray-900 mb-4">Acc√®s non autoris√©</h2>
    <p class="text-gray-600 mb-8">Veuillez vous connecter pour acc√©der √† votre tableau de bord.</p>
    <button class="px-8 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg transition-all duration-200 transform hover:scale-105 shadow-lg"
            routerLink="/auth/login">
      Se connecter
    </button>
  </div>
</div>
