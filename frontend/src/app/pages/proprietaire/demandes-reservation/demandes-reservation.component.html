<div class="max-w-7xl mx-auto p-4 md:p-6">
  <!-- Header -->
  <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-6 gap-4">
    <div>
      <h1 class="text-2xl font-bold text-gray-900">Demandes de Réservation</h1>
      <p class="text-gray-600">Validez ou refusez les demandes pour vos bornes</p>
    </div>
    <button 
      class="px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors"
      routerLink="/proprietaire">
      ← Retour au dashboard
    </button>
  </div>

  <!-- Loading -->
  <div *ngIf="isLoading" class="flex flex-col items-center justify-center py-20">
    <div class="w-12 h-12 border-4 border-orange-600 border-t-transparent rounded-full animate-spin mb-4"></div>
    <p class="text-gray-600">Chargement des demandes...</p>
  </div>

  <!-- Empty State -->
  <div *ngIf="!isLoading && demandes.length === 0" class="bg-white border border-gray-200 rounded-lg p-8 md:p-12 text-center">
    <div class="flex justify-center mb-6">
      <div class="w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center">
        <i class="bi bi-inbox text-4xl text-gray-400"></i>
      </div>
    </div>
    <h2 class="text-2xl font-bold text-gray-900 mb-3">Aucune demande en attente</h2>
    <p class="text-gray-600 mb-6">
      Vous n'avez pas de demande de réservation à traiter pour le moment
    </p>
    <p class="text-sm text-gray-500">
      Les demandes de réservation apparaîtront ici dès qu'un utilisateur souhaitera réserver l'une de vos bornes.
    </p>
  </div>

  <!-- Demandes List -->
  <div *ngIf="!isLoading && demandes.length > 0" class="space-y-4">
    <div *ngFor="let demande of demandes" class="bg-white border border-gray-200 rounded-lg hover:shadow-lg transition-shadow">
      <!-- Header -->
      <div class="p-4 border-b border-gray-200 flex flex-col sm:flex-row sm:items-center justify-between gap-3">
        <div>
          <h3 class="text-lg font-semibold text-gray-900">
            {{ demande.utilisateur.prenom }} {{ demande.utilisateur.nom }}
          </h3>
          <p class="text-sm text-gray-600">{{ demande.utilisateur.email }}</p>
        </div>
        <span class="px-3 py-1 bg-yellow-100 text-yellow-800 text-sm font-medium rounded-full w-fit">
          En attente
        </span>
      </div>

      <!-- Body -->
      <div class="p-4">
        <h4 class="text-sm font-semibold text-gray-700 mb-3">Détails de la réservation</h4>
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
          <!-- Borne -->
          <div class="flex gap-3">
            <div class="flex-shrink-0 w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center">
              <i class="bi bi-lightning-charge-fill text-orange-600"></i>
            </div>
            <div class="flex-1 min-w-0">
              <p class="text-xs font-medium text-gray-500 mb-1">Borne</p>
              <p class="text-sm font-semibold text-gray-900 truncate">
                {{ demande.borne.localisation || 'N/A' }}
              </p>
              <p class="text-xs text-gray-600">
                {{ demande.borne.type || 'N/A' }} - {{ demande.borne.puissance || 0 }} kW
              </p>
            </div>
          </div>

          <!-- Date et heure -->
          <div class="flex gap-3">
            <div class="flex-shrink-0 w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center">
              <i class="bi bi-calendar-check text-blue-600"></i>
            </div>
            <div class="flex-1">
              <p class="text-xs font-medium text-gray-500 mb-1">Date et heure</p>
              <p class="text-sm font-semibold text-gray-900">
                {{ demande.dateDebut | date:'dd/MM/yyyy' }}
              </p>
              <p class="text-xs text-gray-600">
                {{ demande.dateDebut | date:'HH:mm' }} - {{ demande.dateFin | date:'HH:mm' }}
              </p>
            </div>
          </div>

          <!-- Durée -->
          <div class="flex gap-3">
            <div class="flex-shrink-0 w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center">
              <i class="bi bi-clock text-purple-600"></i>
            </div>
            <div class="flex-1">
              <p class="text-xs font-medium text-gray-500 mb-1">Durée</p>
              <p class="text-sm font-semibold text-gray-900">
                {{ calculerDuree(demande.dateDebut, demande.dateFin) }}
              </p>
            </div>
          </div>

          <!-- Revenu estimé -->
          <div class="flex gap-3">
            <div class="flex-shrink-0 w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center">
              <i class="bi bi-cash-coin text-green-600"></i>
            </div>
            <div class="flex-1">
              <p class="text-xs font-medium text-gray-500 mb-1">Revenu estimé</p>
              <p class="text-sm font-semibold text-gray-900">
                {{ demande.montantTotal | currency:'EUR':'symbol':'1.2-2' }}
              </p>
            </div>
          </div>
        </div>
      </div>

      <!-- Actions -->
      <div class="p-4 border-t border-gray-200 flex flex-col sm:flex-row gap-3">
        <button 
          class="flex-1 px-4 py-2.5 border border-red-300 text-red-600 rounded-lg hover:bg-red-50 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2"
          (click)="refuserDemande(demande.idReservation)"
          [disabled]="isLoading">
          <i class="bi bi-x-circle"></i>
          Refuser
        </button>
        <button 
          class="flex-1 px-4 py-2.5 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-medium disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2"
          (click)="accepterDemande(demande.idReservation)"
          [disabled]="isLoading">
          <i class="bi bi-check-circle"></i>
          Accepter
        </button>
      </div>
    </div>
  </div>
</div>
